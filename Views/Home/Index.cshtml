@{
    ViewBag.Title = "Home";
}

@Html.ExibeImagens()

<h3>Encontre seu estabelecimento aqui</h3>

<div class="row">
    <form class="form-inline">
        <div class="form-group">
            <label class="pl-3">Cidade</label>
            <div class="pl-2 pr-4">@Html.DropDownList("Cidade")</div>
        </div>

        <div class="form-group">
            <label class="pl-3">Categoria</label>
            <div class="pl-2 pr-4">@Html.DropDownList("Categoria")</div>
        </div>

        <button type="button" id="pesquisar" class="btn btn-sucess">Pesquisar</button>
        <br /><br />
    </form>
</div>

<div class="row-cols-1">
    <div id="resultados"></div>
</div>

@section Scripts{
    <script>
        $(function () {
            $("#pesquisar").on("click", function (){
                var pesquisa = { IdCidade: $("#Cidade").val(), IdCategoria: $("#Categoria").val() };

                $.getJSON("/home/pesquisar", pesquisa, function(data) {
                    var resultados = $("#resultados");
                    resultados.empty();

                    if (data.length == 0)
                    {
                        resultados.append('<div class="alert alert-warning ">Não encontramos nenhum resuldado para a pesquisa...</div>');
                        return false;
                    }

                    for (var i=0; i < data.length; i++)
                    {
                        if (data[i].Disponivel == true)
                            data[i].Disponivel = "Sim";

                        else
                            data[i].Disponivel = "Não"

                        resultados.append('<div class="alert alert-success">' +
                                          '<h4><b>' + data[i].NomeComercial + '</b></h4>' +
                                          '<p class="m-0"><b>Razao Social: </b>' + data[i].RazaoSocial +'</p>' +
                                          '<p class="m-0"><b>Endereco: </b>' + data[i].Endereco + '</p>' +
                                          '<p class="m-0"><b>Telefone: </b>' + data[i].Telefone + '</p>' +
                                          '<p class="m-0"><b>Disponivel: </b>' + data[i].Site + '</p>' +
                                          '<p class="m-0"><b>Site: </b>' + data[i].Site + '</p>' +
                                          '</div>'
                        );
                    }
                });
             });
        });
    </script>
}